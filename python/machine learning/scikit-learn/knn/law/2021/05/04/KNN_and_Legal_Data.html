<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>K-Nearest Neighbor: Using Machine Learning to Find Analogues in Legal Data | The LitKM Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="K-Nearest Neighbor: Using Machine Learning to Find Analogues in Legal Data" />
<meta name="author" content="Charles Dobson" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A brief intro to NearestNeighbors() from scikit-learn" />
<meta property="og:description" content="A brief intro to NearestNeighbors() from scikit-learn" />
<link rel="canonical" href="http://www.litkm.com/python/machine%20learning/scikit-learn/knn/law/2021/05/04/KNN_and_Legal_Data.html" />
<meta property="og:url" content="http://www.litkm.com/python/machine%20learning/scikit-learn/knn/law/2021/05/04/KNN_and_Legal_Data.html" />
<meta property="og:site_name" content="The LitKM Blog" />
<meta property="og:image" content="http://www.litkm.com/images/social_logo.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-04T00:00:00-05:00" />
<script type="application/ld+json">
{"url":"http://www.litkm.com/python/machine%20learning/scikit-learn/knn/law/2021/05/04/KNN_and_Legal_Data.html","@type":"BlogPosting","headline":"K-Nearest Neighbor: Using Machine Learning to Find Analogues in Legal Data","dateModified":"2021-05-04T00:00:00-05:00","datePublished":"2021-05-04T00:00:00-05:00","image":"http://www.litkm.com/images/social_logo.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://www.litkm.com/python/machine%20learning/scikit-learn/knn/law/2021/05/04/KNN_and_Legal_Data.html"},"author":{"@type":"Person","name":"Charles Dobson"},"description":"A brief intro to NearestNeighbors() from scikit-learn","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="http://www.litkm.com/feed.xml" title="The LitKM Blog" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-188329463-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The LitKM Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">K-Nearest Neighbor: Using Machine Learning to Find Analogues in Legal Data</h1><p class="page-description">A brief intro to `NearestNeighbors()` from scikit-learn</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-05-04T00:00:00-05:00" itemprop="datePublished">
        May 4, 2021
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Charles Dobson</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#machine learning">machine learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#scikit-learn">scikit-learn</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#KNN">KNN</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#law">law</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/litkm/blog/tree/master/_notebooks/2021-5-5-KNN_and_Legal_Data.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/litkm/blog/master?filepath=_notebooks%2F2021-5-5-KNN_and_Legal_Data.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/litkm/blog/blob/master/_notebooks/2021-5-5-KNN_and_Legal_Data.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h1"><a href="#The-K-Nearest-Neighbor-Algorithm">The K-Nearest Neighbor Algorithm </a></li>
<li class="toc-entry toc-h1"><a href="#NearestNeighbors-in-Action">NearestNeighbors in Action </a></li>
<li class="toc-entry toc-h1"><a href="#Applying-KNN-to-Legal-Data">Applying KNN to Legal Data </a></li>
<li class="toc-entry toc-h1"><a href="#Final-Thoughts">Final Thoughts </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-5-5-KNN_and_Legal_Data.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction<a class="anchor-link" href="#Introduction"> </a>
</h1>
<p><em>Have we done a budget for a case like this before?</em> <em>What other matters have we handled with a similar profile to this one?</em> <em>In which other files with characteristics like this one have we brought a summary judgment motion?</em></p>
<p>This type of question arises regularly in a law firm. Answers can sometimes be challenging. Searching databases via keywords or filters is often inefficient at best, and inadequate at worst. Hence the impetus to apply machine learning to this problem.</p>
<p>One approach worth exploring is the <em>k</em>-nearest neighbor algorithm. This is among the oldest and simplest machine learning algorithms. It is typically used for regression and classification problems. But it can also be used just to find analogues in a dataset.</p>
<p>In this post, I introduce the <code>NearestNeighbors()</code> class from the scikit-learn library. This class takes an example, <code>x</code>, and simply returns the element(s) in the dataset that most closely resembles it.</p>
<h1 id="The-K-Nearest-Neighbor-Algorithm">
<a class="anchor" href="#The-K-Nearest-Neighbor-Algorithm" aria-hidden="true"><span class="octicon octicon-link"></span></a>The K-Nearest Neighbor Algorithm<a class="anchor-link" href="#The-K-Nearest-Neighbor-Algorithm"> </a>
</h1>
<p>In a nutshell, KNN processes the elements of a dataset and plots each of them in a multi-dimensional space. The algorithm calculates the location of each element based on its features. The distances between these elements are then used to make predictions.</p>
<p>There is no shortage of excellent tutorials on the KNN algorithm. My favourites include <a href="https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/"><em>Develop k-Nearest Neighbors in Python from Scratch</em></a> on <a href="https://machinelearningmastery.com/">Machine Learning Mastery</a> and <a href="https://realpython.com/knn-python/"><em>The k-Nearest Neighbors Algorithm in Python</em></a> on <a href="https://realpython.com/">Real Python</a>. <a href="https://www.codecademy.com">Codecademy</a> also addresses KNN in its <a href="https://www.codecademy.com/learn/paths/machine-learning"><em>Build a Machine Learning Model with Python</em></a> skills path.</p>
<p>All of the tutorials I have studied address using KNN for classification or regression problems. For instance,</p>
<ul>
<li>Classification: what kind of flower is this example likely to be given the measurements of particular features?</li>
<li>Regression: what is the likely market price of this example of real estate given its various features? (square footage, number of bedrooms, etc.)</li>
</ul>
<p>These tutorials also tend either to focus on coding the KNN algorithm from scratch in Python, or using the <code>KNeighborsClassifier()</code> and <code>KNeighborsRegressor()</code> classes from scikit-learn. All of these approaches rely on calculating "nearest neighbors", but this is not the output the algorithm provides. Rather, the algorithm provides a prediction regarding a classification (<code>x</code> is an example of category <code>y</code>) or a value for regression (<code>x</code> is valued at $<code>y</code>).</p>
<p>But what if the output you want is simply to know which elements in the dataset are the nearest neighbors to <code>x</code>? You could code this from scratch. Or you could use the <code>NearestNeighbor()</code> class from scikit-learn.</p>
<h1 id="NearestNeighbors-in-Action">
<a class="anchor" href="#NearestNeighbors-in-Action" aria-hidden="true"><span class="octicon octicon-link"></span></a>NearestNeighbors in Action<a class="anchor-link" href="#NearestNeighbors-in-Action"> </a>
</h1>
<p>The code below illustrates <code>NearestNeighbor()</code> using a very simple dataset.</p>
<p>In the below snippet, we import our dependencies and create our sample dataset: five elements (rows), each with five features (columns). To create this dataset, we first define a dictionary with five keys (<code>A</code> to <code>E</code>), with each key associated with a list containing five values. This dictionary is then converted into a pandas DataFrame.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
   
<span class="n">samples</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'A'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s1">'B'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s1">'C'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s1">'D'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
        <span class="s1">'E'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]}</span>
  
<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>    A   B   C   D   E
0  10  10  10  10  10
1  20  20  20  20  20
2  30  30  30  30  30
3  40  40  40  40  40
4  50  50  50  50  50
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now suppose we have a new element, <code>x</code>, and we want to know which element in our dataset is the most similar (or nearest neighbor) to it. In this example, <code>x</code> has a value of 9 across the board (i.e. features <code>A</code>, <code>B</code>, <code>C</code>, <code>D</code>, and <code>E</code>).</p>
<p>In the next snippet, we create a new DataFrame comprising the features for <code>x</code>. Then, we instantiate an instance of <code>NearestNeighbor()</code>, assign it to the variable <code>neigh</code>, and load the dataset.</p>
<p>Finally, we run our query using the <code>kneighbors()</code> method to find the nearest neighbor to <code>x</code>, and print the result.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'A'</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span>
     <span class="s1">'B'</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span>
     <span class="s1">'C'</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span>
     <span class="s1">'D'</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span>
     <span class="s1">'E'</span><span class="p">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">]}</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">neigh</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(array([[2.23606798]]), array([[0]]))
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>NearestNeighbor</code> returns <code>2.236</code> and <code>0</code>, indicating the nearest neighbor to <code>x</code> is the element at row <code>0</code> of our dataset, and the distance between these elements is <code>2.236</code>.</p>
<p>Let's try another example, <code>y</code>. This example has a value of 60 across the board.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'A'</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">],</span>
     <span class="s1">'B'</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">],</span>
     <span class="s1">'C'</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">],</span>
     <span class="s1">'D'</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">],</span>
     <span class="s1">'E'</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">]}</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">neigh</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(array([[22.36067977]]), array([[4]]))
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, the nearest neighbor to <code>y</code> is the element at row <code>4</code> of our dataset.</p>
<p>You can find more information about <code>NearestNeighbor()</code> in the documentation for scikit-learn.</p>
<h1 id="Applying-KNN-to-Legal-Data">
<a class="anchor" href="#Applying-KNN-to-Legal-Data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Applying KNN to Legal Data<a class="anchor-link" href="#Applying-KNN-to-Legal-Data"> </a>
</h1>
<p>Admittedly, the preceding example is very abstract when considered in relation to how KNN can be implemented with legal data. Imagine each row of the dataset is one case, and each column is one feature regarding that case (e.g., jurisdiction, case type, etc.)</p>
<p>No sugarcoating: one of the trickiest parts to using KNN to find analagues in legal data is first putting the dataset together. This will usually involve a lot of wrangling. But, hey, it's good practice!</p>
<h1 id="Final-Thoughts">
<a class="anchor" href="#Final-Thoughts" aria-hidden="true"><span class="octicon octicon-link"></span></a>Final Thoughts<a class="anchor-link" href="#Final-Thoughts"> </a>
</h1>
<p>Have you experimented with using KNN on legal data? Hit me up! Let's compare notes.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="litkm/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/machine%20learning/scikit-learn/knn/law/2021/05/04/KNN_and_Legal_Data.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Learning to apply machine learning to litigation.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/litkm" title="litkm"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/LitigationKM" title="LitigationKM"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
